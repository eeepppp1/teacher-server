<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€åˆ«å¼ æ…§ä¿è€å¸ˆ | ä¸ƒå¹´çº§å…­ç­</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(180deg, #f3e7ff, #ffffff);
            color: #333;
            line-height: 1.6;
        }

        .header {
            text-align: center;
            padding: 40px 0;
            background: linear-gradient(135deg, #9c27b0, #673ab7);
            color: white;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 8px 20px rgba(103,58,183,0.3);
        }

        .header h1 {
            margin: 0;
            font-size: 2.2rem;
        }

        .content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .teacher-info {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        .teacher-name {
            font-size: 2rem;
            color: #9c27b0;
            margin: 10px 0;
        }

        .thank-you {
            background-color: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid #9c27b0;
        }

        .message-form {
            background-color: #f0f7ff;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .message-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .message-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.12);
        }

        input, textarea {
            width: 100%;
            padding: 12px;
            margin: 10px 0 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        button {
            background: linear-gradient(135deg, #9c27b0, #673ab7);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            transition: transform 0.1s ease, box-shadow 0.1s ease;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(103,58,183,0.3);
        }

        .messages {
            margin-top: 30px;
        }

        .message-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            border-left: 4px solid #9c27b0;
        }

        .message-author {
            font-weight: bold;
            color: #9c27b0;
        }

        .message-time {
            font-size: 0.9rem;
            color: #888;
            text-align: right;
        }

        .no-messages {
            text-align: center;
            color: #888;
            padding: 30px;
            font-style: italic;
        }

        .admin-panel {
            background: #fff3f6;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            border-left: 5px solid #ff4081;
        }

        .admin-message {
            background: white;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .delete-btn {
            background: #ff4081;
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<div class="header">
    <h1>é€åˆ«å®ä¹ è€å¸ˆå¼ æ…§ä¿</h1>
    <p>ä¸ƒå¹´çº§å…­ç­å…¨ä½“åŒå­¦</p>
</div>

<div class="content">
    <div class="teacher-info">
        <h2 class="teacher-name">å¼ æ…§ä¿ è€å¸ˆ</h2>
        <p>è¯­æ–‡å®ä¹ è€å¸ˆ</p>
        <p>å®ä¹ æ—¶é—´ï¼š2025å¹´9æœˆ - 2026å¹´1æœˆ</p>
    </div>

    <div class="thank-you">
        <h2>æ„Ÿè°¢æ‚¨ï¼</h2>
        <p>äº²çˆ±çš„å¼ è€å¸ˆï¼š</p>
        <p>æ„Ÿè°¢æ‚¨è¿™ä¸€å­¦æœŸä»¥æ¥å¯¹æˆ‘ä»¬çš„è¾›å‹¤æ•™å¯¼ã€‚æ‚¨çš„è¯­æ–‡è¯¾ç”ŸåŠ¨æœ‰è¶£ï¼Œè®©æˆ‘ä»¬æ„Ÿå—åˆ°äº†ä¸­åæ–‡åŒ–çš„é­…åŠ›ã€‚</p>
        <p>åœ¨æœŸæœ«è€ƒè¯•å‰ï¼Œæ‚¨è€å¿ƒåœ°ä¸ºæˆ‘ä»¬è§£ç­”é—®é¢˜ï¼Œç‰ºç‰²è‡ªå·±çš„ä¼‘æ¯æ—¶é—´ã€‚æˆ‘ä»¬éå¸¸æ„Ÿæ¿€ï¼</p>
        <p>è™½ç„¶æ‚¨çš„å®ä¹ æœŸç»“æŸäº†ï¼Œä½†æ‚¨çš„æ•™è¯²æˆ‘ä»¬ä¼šæ°¸è¿œè®°ä½ã€‚ç¥æ‚¨å‰ç¨‹ä¼¼é”¦ï¼Œæœªæ¥ä¸€åˆ‡é¡ºåˆ©ï¼</p>
        <p style="text-align: right;">â€”â€” ä¸ƒå¹´çº§å…­ç­å…¨ä½“åŒå­¦</p>
    </div>

    <div class="message-form">
        <h2>å†™ä¸‹æ‚¨çš„ç¥ç¦</h2>
        <form id="messageForm">
            <label>æ‚¨çš„å§“åï¼š</label>
            <input type="text" id="studentName" required>

            <label>ç¥ç¦å†…å®¹ï¼š</label>
            <textarea id="message" rows="4" required></textarea>

            <button type="submit">æäº¤ç¥ç¦</button>
        </form>
    </div>

    <div class="messages">
        <h2>åŒå­¦ä»¬çš„ç¥ç¦</h2>
        <div id="messagesContainer">
            <div class="no-messages">æ­£åœ¨åŠ è½½ç•™è¨€...</div>
        </div>
    </div>
</div>

<div class="footer" style="text-align:center;color:#666;">
    <p>ä¸ƒå¹´çº§å…­ç­é€åˆ«å¼ è€å¸ˆç½‘ç«™</p>
</div>
<!-- ===== ç®¡ç†å‘˜åå° ===== -->
<div class="admin-panel" id="adminPanel">
    <h2>ç®¡ç†å‘˜åå°</h2>
    <p>è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç ï¼š</p>
    <input type="password" id="adminPassword" placeholder="è¾“å…¥å¯†ç ">
    <button onclick="loginAdmin()">ç™»å½•</button>

    <div id="adminControls" style="display:none; margin-top:20px;">
        <h3>ç®¡ç†ç•™è¨€</h3>
        <div id="adminMessages"></div>
    </div>
</div>

<script>
// âš ï¸ éƒ¨ç½²åä¸€å®šè¦æ¢æˆ Render ç»™ä½ çš„åœ°å€ï¼Œä¾‹å¦‚ï¼š
// const API_URL = "https://teacher-server-xxxx.onrender.com";
const API_URL = "https://teacher-server-production.up.railway.app";

let messages = [];

// åŠ è½½ç•™è¨€
async function loadMessages() {
    try {
        const res = await fetch(API_URL + "/get-messages");
        messages = await res.json();
        displayMessages();
    } catch (err) {
        console.error("åŠ è½½å¤±è´¥ï¼š", err);
        document.getElementById('messagesContainer').innerHTML =
            "<div class='no-messages'>æ— æ³•è¿æ¥æœåŠ¡å™¨ï¼Œè¯·ç¨åå†è¯•</div>";
    }
}

function displayMessages() {
    const container = document.getElementById('messagesContainer');

    if (!messages || messages.length === 0) {
        container.innerHTML =
            "<div class='no-messages'>è¿˜æ²¡æœ‰ç•™è¨€ï¼Œæˆä¸ºç¬¬ä¸€ä¸ªé€ä¸Šç¥ç¦çš„åŒå­¦å§ï¼</div>";
        return;
    }

    let html = "";
    [...messages].reverse().forEach(msg => {
        html += `
        <div class="message-card">
            <div class="message-author">${msg.name}</div>
            <div class="message-content">${msg.message}</div>
            <div class="message-time">${msg.time}</div>
        </div>
        `;
    });

    container.innerHTML = html;
}

// æäº¤ç•™è¨€
document.getElementById("messageForm").addEventListener("submit", async function (e) {
    e.preventDefault();

    const name = document.getElementById("studentName").value.trim();
    const message = document.getElementById("message").value.trim();

    if (!name || !message) {
        alert("è¯·å¡«å†™å§“åå’Œç¥ç¦å†…å®¹ï¼");
        return;
    }

    const newMessage = {
        name,
        message,
        time: new Date().toLocaleDateString("zh-CN") + " " +
              new Date().toLocaleTimeString("zh-CN", {hour:"2-digit", minute:"2-digit"})
    };

    try {
        await fetch(API_URL + "/add-message", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify(newMessage)
        });

        document.getElementById("studentName").value = "";
        document.getElementById("message").value = "";

        await loadMessages();
        alert("ç¥ç¦æäº¤æˆåŠŸï¼");
    } catch (err) {
        alert("æäº¤å¤±è´¥ï¼Œè¯·æ£€æŸ¥æœåŠ¡å™¨ï¼");
        console.error(err);
    }
});

const ADMIN_PASSWORD = "wgz12345"; // ğŸ‘‰ ä½ å¯ä»¥æ”¹æˆè‡ªå·±çš„å¯†ç 

async function loginAdmin() {
    const pwd = document.getElementById("adminPassword").value;
    if (pwd !== ADMIN_PASSWORD) {
        alert("å¯†ç é”™è¯¯ï¼");
        return;
    }

    document.getElementById("adminControls").style.display = "block";
    loadAdminMessages();
}

async function loadAdminMessages() {
    const res = await fetch(API_URL + "/get-messages");
    const data = await res.json();

    const container = document.getElementById("adminMessages");
    let html = "";

    data.forEach(msg => {
        html += `
        <div class="admin-message">
            <b>${msg.name}</b>ï¼š${msg.message}
            <br>
            <small>${msg.time}</small>
            <br>
            <button class="delete-btn" onclick="deleteMessage('${msg._id}')">åˆ é™¤</button>
        </div>
        `;
    });

    container.innerHTML = html;
}

async function deleteMessage(id) {
    if (!confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡ç•™è¨€å—ï¼Ÿ")) return;

    await fetch(API_URL + "/delete-message/" + id, { method: "DELETE" });
    alert("å·²åˆ é™¤ï¼");
    loadAdminMessages();
    loadMessages(); // åˆ·æ–°å‰å°ç•™è¨€
}

document.addEventListener("DOMContentLoaded", loadMessages);
</script>

</body>
</html>




